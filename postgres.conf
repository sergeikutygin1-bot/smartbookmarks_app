# Performance tuning for auto-save workload
# Optimized for write-heavy operations with frequent small updates

# Network Settings
listen_addresses = '*'              # Listen on all interfaces (required for Docker)

# Memory Settings
shared_buffers = 256MB              # 25% of available RAM
effective_cache_size = 1GB          # 75% of RAM (estimate for query planner)
work_mem = 16MB                     # Memory for sorts and joins
maintenance_work_mem = 128MB        # Memory for maintenance operations

# Disk I/O Settings
random_page_cost = 1.1              # SSD-optimized (lower than HDD default of 4.0)
effective_io_concurrency = 200      # For SSD storage

# Write-Ahead Log (WAL) Settings
checkpoint_timeout = 15min          # Reduce checkpoint frequency for better write performance
max_wal_size = 2GB                  # Allow larger WAL before checkpoint
min_wal_size = 1GB                  # Keep more WAL segments

# Auto-vacuum Settings (critical for UPDATE-heavy workload)
autovacuum = on
autovacuum_naptime = 30s            # Check more frequently for dead tuples
autovacuum_vacuum_scale_factor = 0.1  # Vacuum when 10% of table is dead tuples (vs default 20%)
autovacuum_analyze_scale_factor = 0.05  # Analyze more frequently

# Connection Settings
max_connections = 100               # Maximum concurrent connections
shared_preload_libraries = 'pg_stat_statements'  # Query performance monitoring

# Logging (for development - disable in production)
log_statement = 'none'              # Don't log all statements (too verbose)
log_duration = off                  # Don't log duration of every statement
log_min_duration_statement = 1000   # Log queries taking longer than 1 second

# Locale Settings
lc_messages = 'en_US.utf8'
lc_monetary = 'en_US.utf8'
lc_numeric = 'en_US.utf8'
lc_time = 'en_US.utf8'
default_text_search_config = 'pg_catalog.english'
